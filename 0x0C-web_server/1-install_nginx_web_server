#!/usr/bin/env bash
#install ngix in web server
CONFIGURE_SERVER=\
"server {
	listen 80;
	listen [::]:80;

	server_name Gramins.com;

	root /var/www/Gramins.com;
	index index.html;

	location / {
	}
}"
#update and install Nginx
sudo apt -y update 
sudo apt install -y nginx
#create the web directory
sudo mkdir -p /var/www/Gramins.com
#unlink the site-enabled config file
sudo unlink /etc/nginx/sites-enabled/default
# Configure nginx to listen on port 80
sudo echo "{$CONFIGURE_SERVER}" | sudo tee /etc/nginx/sites-available/Gramins.com
#create a link to the site-enabled folder
sudo ln -s /etc/nginx/sites-available/Gramins.com /etc/nginx/sites-enabled/
#configure firewall to allow both http and https traffic
sudo ufw allow 'nginx full'
sudo ufw reload
#configure ownership and permissions
sudo chown -R "$USER":"$USER" /var/www
sudo chmod -R 755 /var/www
#creating an index file to be displayed on the browser
echo "Hello World!" > /var/www/Gramins.com/index.html
# Restart nginx without using systemctl
sudo service nginx restart
